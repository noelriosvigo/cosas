import os
import hashlib

def generate_addons_xml(addons_path):
    addons_xml = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<addons>\n'
    for folder in os.listdir(addons_path):
        folder_path = os.path.join(addons_path, folder)
        addon_file = os.path.join(folder_path, 'addon.xml')
        if os.path.isfile(addon_file):
            with open(addon_file, 'r', encoding='utf-8') as f:
                addons_xml += f.read().strip() + '\n'
    addons_xml += '</addons>\n'
    with open('addons.xml', 'w', encoding='utf-8') as f:
        f.write(addons_xml)
    md5_hash = hashlib.md5(addons_xml.encode('utf-8')).hexdigest()
    with open('addons.xml.md5', 'w') as f:
        f.write(md5_hash)

generate_addons_xml('./')  # Ejecutar desde la ra√≠z del repositorio
